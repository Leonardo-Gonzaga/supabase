---
title: Infinite List
description: List component with infinite scrolling capabilities using Supabase.
---

<BlockPreview name="infinite-list-demo" />

## Installation

<BlockItem
  name="infinite-list-nextjs"
  description="Installs the Infinite List component and necessary Supabase client setup for Next.js."
/>

## Folder structure

<RegistryBlock itemName="infinite-list-nextjs" />

## Introduction

The Infinite List component provides a scrollable container that loads data progressively from your Supabase database as the user scrolls down. It uses a custom hook to manage data fetching and pagination state, and allows flexible rendering via a `renderItem` prop.

## Prerequisites

1. **Supabase Project:** You need a Supabase project set up.
2. **Supabase Table:** A table in your Supabase database that you want to display.
3. **Environment Variables:** Ensure your Next.js application has the following environment variables set up (usually in a `.env.local` file):
   ```env
   NEXT_PUBLIC_SUPABASE_URL=YOUR_SUPABASE_URL
   NEXT_PUBLIC_SUPABASE_ANON_KEY=YOUR_SUPABASE_ANON_KEY
   ```
4. **Required Packages:** Make sure you have the following packages installed:
   ```bash
   npm install @supabase/supabase-js @supabase/ssr @supabase/postgrest-js
   ```

## Usage

### Basic usage

```tsx
import { InfiniteList } from '@/registry/default/blocks/infinite-list/components/infinite-list'

// Define your data type (matching your Supabase table structure)
type Log = {
  id: number
  log_message: string
  log_level: string
  created_at: string
}

export default function LogsPage() {
  // Define how each item should be rendered
  const renderLogItem = (log: Log) => {
    return (
      <div className="border-b py-3 px-4 hover:bg-muted flex items-center justify-between">
        <div>
          <span className="font-medium text-sm text-foreground">
            {log.log_message} (ID: {log.id})
          </span>
          <div className="text-sm text-foreground-light">
            {new Date(log.created_at).toLocaleDateString()}
          </div>
        </div>
        <span className="text-xs text-foreground-light rounded-lg py-2 px-3 bg-muted">
          {log.log_level}
        </span>
      </div>
    )
  }

  return (
    <div className="h-[600px]">
      <InfiniteList<Log> tableName="logging_data" renderItem={renderLogItem} pageSize={15} />
    </div>
  )
}
```

### With filtering

```tsx
import { InfiniteList } from '@/registry/default/blocks/infinite-list/components/infinite-list'
import { type PostgrestFilterBuilder } from '@supabase/postgrest-js'

// Define your data type
type Log = {
  id: number
  log_message: string
  log_level: string
  created_at: string
}

export default function InfoLogsPage() {
  const renderLogItem = (log: Log) => {
    // Render implementation
  }

  // Define a filter to only show logs with log_level = 'INFO'
  const filterLogsToInfo = (query: PostgrestFilterBuilder<any, any, any>) => {
    return query.eq('log_level', 'INFO')
  }

  return (
    <div className="h-[600px]">
      <InfiniteList<Log>
        tableName="logging_data"
        renderItem={renderLogItem}
        pageSize={15}
        filterBuilder={filterLogsToInfo}
      />
    </div>
  )
}
```

### Custom appearance

```tsx
import { InfiniteList } from '@/registry/default/blocks/infinite-list/components/infinite-list'

export default function CustomLogsPage() {
  // Render implementation...

  return (
    <InfiniteList<Log>
      tableName="logging_data"
      renderItem={renderLogItem}
      className="h-[800px] border-2 border-primary"
      listClassName="space-y-4 p-6"
      renderNoResults={() => (
        <div className="text-center p-8 bg-muted rounded-lg">No logs found</div>
      )}
      renderEndMessage={() => <div className="text-center p-4 text-primary">All logs loaded!</div>}
      renderSkeleton={(count) => (
        <div className="space-y-2 animate-pulse">
          {Array.from({ length: count }).map((_, i) => (
            <div key={i} className="h-20 bg-muted rounded-md" />
          ))}
        </div>
      )}
    />
  )
}
```

## Features

- **Infinite Scrolling:** Automatically fetches more data as the user scrolls
- **Supabase Integration:** Direct integration with Supabase tables
- **Flexible Rendering:** Highly customizable item rendering
- **Server-side Filtering:** Apply filters directly to your Supabase queries
- **Loading States:** Customizable loading skeletons and status messages
- **Optimized Performance:** Efficient intersection observer implementation
- **Full Customization:** All aspects of the list appearance can be adjusted

## Props

| Prop               | Type                                                        | Description                                                                                          |
| ------------------ | ----------------------------------------------------------- | ---------------------------------------------------------------------------------------------------- |
| `tableName`        | `string`                                                    | **Required.** The name of the Supabase table to fetch data from.                                     |
| `renderItem`       | `(item: TData, index: number) => React.ReactNode`           | **Required.** Function that renders each item in the list.                                           |
| `pageSize`         | `number`                                                    | Number of items to fetch per page. Defaults to `20`.                                                 |
| `selectQuery`      | `string`                                                    | Columns to select from the table. Defaults to `'*'`.                                                 |
| `filterBuilder`    | `(query: PostgrestFilterBuilder) => PostgrestFilterBuilder` | Function to apply filters or sorting to the Supabase query.                                          |
| `className`        | `string`                                                    | Class name for the outer scrollable container.                                                       |
| `listClassName`    | `string`                                                    | Class name for the inner div containing list items.                                                  |
| `renderNoResults`  | `() => React.ReactNode`                                     | Function to render content when no results are found. Default: "No results."                         |
| `renderEndMessage` | `() => React.ReactNode`                                     | Function to render message at the end of the list. Default: "You've reached the end."                |
| `renderSkeleton`   | `(count: number) => React.ReactNode`                        | Function to render loading skeletons. Default: `count` number of skeleton items with default height. |

## TData interface

The component is generic and accepts any data type that matches your Supabase table structure. For example:

```typescript
type Log = {
  id: number
  log_message: string
  log_level: string
  created_at: string
}

// Then use it with the generic parameter
<InfiniteList<Log> ... />
```

## Advanced usage

### Custom filtering and sorting

```tsx
const advancedFilter = (query: PostgrestFilterBuilder<any, any, any>) => {
  return query
    .eq('status', 'active')
    .gte('created_at', '2023-01-01')
    .order('created_at', { ascending: false })
}

;<InfiniteList tableName="users" renderItem={renderUser} filterBuilder={advancedFilter} />
```

### Custom skeleton rendering

```tsx
const renderCustomSkeleton = (count: number) => (
  <div className="space-y-4">
    {Array.from({ length: count }).map((_, i) => (
      <div key={i} className="flex gap-4">
        <div className="rounded-full bg-muted h-12 w-12" />
        <div className="space-y-2 flex-1">
          <div className="h-4 bg-muted rounded w-3/4" />
          <div className="h-3 bg-muted rounded w-1/2" />
        </div>
      </div>
    ))}
  </div>
)

<InfiniteList
  renderSkeleton={renderCustomSkeleton}
  // other props...
/>
```

## Further reading

- [Supabase PostgreSQL API](https://supabase.com/docs/reference/javascript/introduction)
- [Supabase Pagination](https://supabase.com/docs/reference/javascript/select#pagination)
- [Intersection Observer API](https://developer.mozilla.org/en-US/docs/Web/API/Intersection_Observer_API)
